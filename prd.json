{
  "project": "NutritionAI",
  "branchName": "ralph/user-auth-dashboard",
  "description": "User Management and Home Dashboard - Add user authentication, account management, and personalized home dashboard",
  "userStories": [
    {
      "id": "US-001",
      "title": "Add User database model and authentication schema",
      "description": "As a developer, I need to store user accounts and link meal analyses to users.",
      "acceptanceCriteria": [
        "Add User model to Prisma schema with fields: id, email (unique), passwordHash, name, createdAt",
        "Add userId field to MealAnalysis (nullable for backward compatibility)",
        "Add index on MealAnalysis.userId for performance",
        "Generate and run Prisma migration successfully",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Implement JWT authentication service",
      "description": "As a backend developer, I need JWT token generation and validation for secure authentication.",
      "acceptanceCriteria": [
        "Create auth service with generateToken and verifyToken functions",
        "Tokens include userId, email in payload",
        "Tokens expire after 30 days",
        "Use environment variable for JWT secret",
        "Hash passwords using bcrypt",
        "Add bcryptjs and jsonwebtoken dependencies",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Create authentication middleware",
      "description": "As a backend developer, I need middleware to protect authenticated routes.",
      "acceptanceCriteria": [
        "Create auth middleware that validates JWT from Authorization header",
        "Attach user object to request context",
        "Return 401 for missing/invalid tokens",
        "Return 403 for expired tokens",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Add auth endpoints (register, login)",
      "description": "As a user, I want to create an account and login to access my personalized data.",
      "acceptanceCriteria": [
        "POST /api/auth/register - creates user, returns JWT token",
        "POST /api/auth/login - validates credentials, returns JWT token",
        "Validate email format and password strength (min 8 chars)",
        "Return 400 for duplicate email on registration",
        "Return 401 for invalid credentials on login",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Add user stats endpoint",
      "description": "As a user, I want to see my meal statistics on the home dashboard.",
      "acceptanceCriteria": [
        "GET /api/user/stats - returns meal count, avg calories, totals",
        "Requires authentication (use auth middleware)",
        "Calculate stats from user's MealAnalysis records",
        "Return stats for: today, this week, all time",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Protect analyze endpoint with authentication",
      "description": "As a developer, I need to associate meal analyses with the authenticated user.",
      "acceptanceCriteria": [
        "Add auth middleware to POST /api/analyze route",
        "Store userId when creating MealAnalysis",
        "Return 401 if not authenticated",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Create User and UserStats iOS models",
      "description": "As an iOS developer, I need Swift models for user data.",
      "acceptanceCriteria": [
        "Create User model matching backend (id, email, name)",
        "Create UserStats model (todayMeals, weekMeals, avgCalories, etc.)",
        "Both models conform to Codable",
        "Compile and typecheck passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Create iOS AuthService for state management",
      "description": "As an iOS developer, I need centralized authentication state management.",
      "acceptanceCriteria": [
        "Create AuthService with @Published isAuthenticated property",
        "Store JWT token in iOS Keychain securely",
        "Implement login, register, logout functions",
        "Auto-login on app launch if valid token exists",
        "Clear token on logout",
        "Compile and typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Update APIService with authentication",
      "description": "As a developer, I need API calls to include authentication headers.",
      "acceptanceCriteria": [
        "Add Authorization header with Bearer token to all requests",
        "Add register() and login() API methods",
        "Add fetchUserStats() API method",
        "Handle 401 responses by triggering logout",
        "Existing API methods still work",
        "Compile and typecheck passes"
      ],
      "priority": 9,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Create Login and Register views",
      "description": "As a user, I want to login or create an account from the app.",
      "acceptanceCriteria": [
        "LoginView with email and password fields",
        "RegisterView with email, name, password, confirm password fields",
        "Both views show loading state during API calls",
        "Show error messages for failed auth",
        "Navigate to main app on successful auth",
        "Link between Login and Register views",
        "Compile and typecheck passes"
      ],
      "priority": 10,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-011",
      "title": "Create StatsCard component for dashboard",
      "description": "As a user, I want to see my nutrition stats in visually clear cards.",
      "acceptanceCriteria": [
        "Reusable StatsCard component with title, value, subtitle",
        "Support different stat types (count, calories, macros)",
        "Clean, card-based design with system colors",
        "Responsive layout in grid",
        "Compile and typecheck passes"
      ],
      "priority": 11,
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-012",
      "title": "Create QuickCaptureTile component",
      "description": "As a user, I want quick-access tiles to capture full meals or partial meals.",
      "acceptanceCriteria": [
        "QuickCaptureTile component with icon, label, and action",
        "Tappable tile that triggers camera or specific capture flow",
        "Support for Full Meal, Snack, Quick Add options",
        "Visual feedback on tap",
        "Compile and typecheck passes"
      ],
      "priority": 12,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-013",
      "title": "Create HomeView dashboard",
      "description": "As a user, I want a home dashboard showing my stats and quick meal capture options.",
      "acceptanceCriteria": [
        "Display welcome message with user's name",
        "Show stats grid with today/week/total meals and calories",
        "Show quick capture tiles for Full Meal, Snack, Quick Add",
        "Refresh stats when view appears",
        "Show loading state while fetching stats",
        "Show empty state for new users",
        "Compile and typecheck passes"
      ],
      "priority": 13,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-014",
      "title": "Add HomeView to TabView and update app flow",
      "description": "As a user, I want the Home tab to be the first tab when I open the app.",
      "acceptanceCriteria": [
        "Add HomeView as first tab in TabView",
        "Show login screen if not authenticated",
        "Show main TabView with Home tab if authenticated",
        "Home tab uses house.fill SF Symbol",
        "Existing tabs (Camera, History, Settings) still work",
        "Tab order: Home, Camera, History, Settings",
        "Compile and typecheck passes"
      ],
      "priority": 14,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-015",
      "title": "Add logout functionality to Settings",
      "description": "As a user, I want to logout from my account in the Settings tab.",
      "acceptanceCriteria": [
        "Add Logout button to SettingsView",
        "Tapping logout clears auth token and returns to login",
        "Show confirmation dialog before logout",
        "Existing settings functionality still works",
        "Compile and typecheck passes"
      ],
      "priority": 15,
      "passes": false,
      "notes": ""
    }
  ]
}
